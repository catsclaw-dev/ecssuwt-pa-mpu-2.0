{% extends "base.html" %}{% block content %}
<h1>{% if mode=='new' %}Новая задача{% else %}Редактировать задачу{% endif %}</h1>
<form method="post" class="card">{% csrf_token %}
  {% if mode=='new' %}
    <label>Проект*<select class="input" name="project_id" required>
      <option value="">— выберите —</option>
      {% for p in projs %}<option value="{{ p.project_id }}" {% if sel_pid==p.project_id|stringformat:'s' %}selected{% endif %}>[{{ p.project_id }}] {{ p.project_name }}</option>{% endfor %}
    </select></label><br>
  {% else %}
    <p>Проект: [{{ task.project_id }}] {{ task.project_name }}</p>
  {% endif %}
  <label>Название*<input class="input" name="task_name" value="{{ task.task_name }}"></label><br>
  <label>Описание<textarea class="textarea" name="task_description">{{ task.task_description }}</textarea></label><br>
  <label>Статус<select class="input" name="task_status">
    {% for s in "open,in_review,done".split(",") %}
      <option value="{{ s }}" {% if task.task_status==s %}selected{% endif %}>{{ s }}</option>
    {% endfor %}
  </select></label><br>
  <label>Дедлайн<input class="input" type="datetime-local" name="task_deadline" value="{{ task.task_deadline|date:'Y-m-d\\TH:i' }}"></label><br>
  <label>Исполнитель (студент)
    <select class="input" name="executor_student">
      <option value="">— не назначать —</option>
      {% for sid, fio in students %}<option value="{{ sid }}" {% if task.executor_student == sid %}selected{% endif %}>{{ fio }}</option>{% endfor %}
    </select>
  </label><br>
  <button class="btn">Сохранить</button>
  <a class="btn btn-secondary" href="{% url 'adminboard:tasks-list' %}">Отмена</a>
</form>
{% endblock %}
